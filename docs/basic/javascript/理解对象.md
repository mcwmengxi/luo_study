---
title: å¯¹è±¡
---

## å¯¹è±¡

### æ™®é€šå¯¹è±¡
**è®¡ç®—å±æ€§**
å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¹è±¡å­—é¢é‡ä¸­ä½¿ç”¨æ–¹æ‹¬å·ã€‚è¿™å«åšè®¡ç®—å±æ€§ã€‚
[fruit] å«ä¹‰æ˜¯å±æ€§ååº”è¯¥ä»fruitå˜é‡ä¸­è·å–ã€‚
```javascript
let fruit = prompt("Which fruit to buy?", "apple");

let bag = {
  [fruit]: 5, // å±æ€§åæ˜¯ä» fruit å˜é‡ä¸­å¾—åˆ°çš„
};

alert( bag.apple ); // 5 å¦‚æœ fruit="apple"
```
**å±æ€§å­˜å‚¨å’Œè®¿é—®åŠå…¶å®ƒ**
- å­˜å‚¨å±æ€§é‡‡ç”¨é”®å€¼å¯¹å½¢å¼ï¼Œå…¶ä¸­ï¼šå±æ€§çš„é”®å¿…é¡»æ˜¯å­—ç¬¦ä¸²æˆ–è€…symbol(é€šå¸¸æ˜¯å­—ç¬¦ä¸²),å€¼å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚
- è®¿é—®å±æ€§
  - ç‚¹ç¬¦å·: obj.propertyã€‚å½“å±æ€§åæ˜¯å·²çŸ¥ä¸”ç®€å•çš„æ—¶å€™
  - æ–¹æ‹¬å· obj["property"]ï¼Œæ–¹æ‹¬å·å…è®¸ä»å˜é‡ä¸­è·å–é”®ï¼Œä¾‹å¦‚ obj[varWithKey]ã€‚
- å…¶ä»–æ“ä½œï¼š
  - åˆ é™¤å±æ€§ï¼šdelete obj.propã€‚
  - æ£€æŸ¥æ˜¯å¦å­˜åœ¨ç»™å®šé”®çš„å±æ€§ï¼š"key" in objã€‚
  - éå†å¯¹è±¡ï¼šfor(let key in obj) å¾ªç¯ã€‚
- ç”¨constå£°æ˜çš„å¯¹è±¡èƒ½è¢«ä¿®æ”¹ã€‚const å£°æ˜ä»…å›ºå®šuserçš„å€¼ï¼Œè€Œä¸æ˜¯è¯¥å¯¹è±¡é‡Œé¢çš„å†…å®¹ã€‚å½“æˆ‘ä»¬å°è¯•å°†user=...ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œèµ‹å€¼æ—¶,constæ‰ä¼šæŠ›å‡ºé”™è¯¯ã€‚

### å¯¹è±¡å¼•ç”¨å’Œå¤åˆ¶
- å¯¹è±¡é€šè¿‡å¼•ç”¨è¢«èµ‹å€¼å’Œæ‹·è´ã€‚è¢«èµ‹å€¼äº†å¯¹è±¡ç±»å‹çš„å˜é‡å­˜å‚¨çš„ä¸æ˜¯å¯¹è±¡æœ¬èº«ï¼Œè€Œæ˜¯è¯¥å¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€(è¯¥å¯¹è±¡çš„å¼•ç”¨)
- å½“å¯¹è±¡å˜é‡è¢«å¤åˆ¶æ—¶ï¼Œåªæ˜¯å¼•ç”¨è¢«å¤åˆ¶ï¼Œä¸¤è€…æŒ‡å‘çš„è¿˜æ˜¯åŒä¸€ä¸ªå†…å­˜åœ°å€(åŒä¸€ä¸ªå¯¹è±¡)
```javascript
let user = { name: 'John' };
let admin = user;

admin.name = 'Pete'; // é€šè¿‡ "admin" å¼•ç”¨æ¥ä¿®æ”¹
alert(user.name); // 'Pete'ï¼Œä¿®æ”¹èƒ½é€šè¿‡ "user" å¼•ç”¨çœ‹åˆ°
```
![image-name](https://zh.javascript.info/article/object-copy/variable-copy-reference.svg)

- ä¸ºäº†åˆ›å»ºâ€œçœŸæ­£çš„æ‹·è´â€(ä¸€ä¸ªå…‹éš†)ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Object.assign æ¥åšæ‰€è°“çš„â€œæµ…æ‹·è´â€ï¼ˆåµŒå¥—å¯¹è±¡é€šè¿‡å¼•ç”¨è¿›è¡Œæ‹·è´ï¼‰
```javascript
// æµ…æ‹·è´
let user = {
    name: "nangong",
    sizes: {
      height: 182,
      width: 50
    }
};
let newUser = Object.assign({},user)

console.log(newUser==user);//false
console.log(newUser.sizes===user.sizes);// true åµŒå¥—å¯¹è±¡é€šè¿‡å¼•ç”¨è¢«å¤åˆ¶,å®é™…è¿˜æ˜¯å…±ç”¨ä¸€ä¸ªåœ°å€

// ç±»ä¼¼ä¸_.clone(objects);
var objects = [{ 'a': 1 }, { 'b': 2 }];
let newObj = Object.assign([],objects)
console.log(newObj===objects);// false
console.log(newObj[0]===objects[0]);// true
```
- ä¸ºäº†åˆ›å»ºâ€œçœŸæ­£çš„æ‹·è´â€(ä¸€ä¸ªå…‹éš†),ä¹Ÿå¯ä»¥ä½¿ç”¨â€œæ·±æ‹·è´â€å‡½æ•°ï¼Œä¾‹å¦‚ _.cloneDeep(obj)ã€‚
```javascript
// lodashåº“æ·±å…‹éš†å‡½æ•°
var objects = [{ 'a': 1 }, { 'b': 2 }];
 
var deep = _.cloneDeep(objects);
console.log(deep[0] === objects[0]);// => false

// ä»¥menusä¸ºä¾æ®é€šè¿‡é€’å½’å®ç°çš„æ·±å…‹éš†å‡½æ•°,æœ‰äº›å…¶ä»–æƒ…å†µæ²¡æœ‰å®Œå–„
function cloneDeep(obj){
    let clone
    clone = {}
    if(obj instanceof Array){
        clone =[]
    }
    for(let key in obj){
        if(typeof obj[key] === "object"){
            if(obj[key] instanceof Array){
                clone[key] = []
                obj[key].forEach((item,index) => {
                    if(typeof item === "object"){
                        clone[key][index] = cloneDeep(item)
                    }else{
                        clone[key][index] =item
                    }
                })
                
            }else{
                clone[key] = cloneDeep(obj[key])
            }
            
        }else{
            clone[key] = obj[key]
        }
    }
    return clone
}
var objects = [{ 'a': 1 }, { 'b': 2 }];
var objectArr = {
    a:[{ 'a': 1 }, { 'b': 2 }],
    b:[{ 'a': 1 }, { 'b': 2 }]
}
let user = {
    name: "nangong",
    sizes: {
      height: 182,
      width: 50
    }
};
const menus ={
    a:[
    {
      text: 'ç”¨æˆ·ç®¡ç†',
      icon: 'el-icon-setting',
      routerName: '',
      submenus: [
        {
          text: 'æœåŠ¡ä¿¡æ¯',
          routerName: 'ServiceList'
        },
        {
          text: 'æ–°å¢åŠŸèƒ½',
          routerName: 'ServiceEdit'
        }
      ]
    },
    {
      text: 'äº§å“ç®¡ç†',
      icon: 'el-icon-menu',
      submenus: [{ text: 'äº§å“ä¿¡æ¯', routerName: 'Product' }]
    },
    {
      text: 'æ—¥å¿—ä¿¡æ¯',
      icon: 'el-icon-message',
      routerName: ''
    },
    {
      text: 'è‡ªå®šä¹‰å›¾ç‰‡ä¸Šä¼ ',
      icon: 'el-icon-upload',
      routerName: ''
    },
    3
  ],
  b:{
      "b-a":1
  },
  c:0
}
let empty =[{}]
let deep = cloneDeep(menus)
console.log(deep);
// console.log(deep[0]===objects[0]);
// console.log(deep.a[0]===objectArr.a[0]);
// console.log(deep.sizes===user.sizes);
console.log(deep.a[1]===menus.a[1]);
```


### åƒåœ¾å›æ”¶
**åƒåœ¾å›æ”¶åŸºæœ¬ç®—æ³•**
`mark-and-sweep`å®šæœŸæ‰§è¡Œä»¥ä¸‹â€œåƒåœ¾å›æ”¶â€æ­¥éª¤ï¼š
  * åƒåœ¾æ”¶é›†å™¨æ‰¾åˆ°æ‰€æœ‰çš„æ ¹ï¼Œå¹¶â€œæ ‡è®°â€ï¼ˆè®°ä½ï¼‰å®ƒä»¬ã€‚
  * ç„¶åå®ƒéå†å¹¶â€œæ ‡è®°â€æ¥è‡ªå®ƒä»¬çš„æ‰€æœ‰å¼•ç”¨ã€‚
  * ç„¶åå®ƒéå†æ ‡è®°çš„å¯¹è±¡å¹¶æ ‡è®° å®ƒä»¬çš„ å¼•ç”¨ã€‚æ‰€æœ‰è¢«éå†åˆ°çš„å¯¹è±¡éƒ½ä¼šè¢«è®°ä½ï¼Œä»¥å…å°†æ¥å†æ¬¡éå†åˆ°åŒä¸€ä¸ªå¯¹è±¡ã€‚
  * â€¦â€¦å¦‚æ­¤æ“ä½œï¼Œç›´åˆ°æ‰€æœ‰å¯è¾¾çš„ï¼ˆä»æ ¹éƒ¨ï¼‰å¼•ç”¨éƒ½è¢«è®¿é—®åˆ°ã€‚
  * æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡éƒ½ä¼šè¢«åˆ é™¤ã€‚
![image-name](https://zh.javascript.info/article/garbage-collection/garbage-collection-5.svg)
**æ€»ç»“**
- åƒåœ¾å›æ”¶æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œæˆ‘ä»¬ä¸èƒ½å¼ºåˆ¶æ‰§è¡Œæˆ–æ˜¯é˜»æ­¢æ‰§è¡Œã€‚
- å½“å¯¹è±¡æ˜¯å¯è¾¾çŠ¶æ€æ—¶ï¼Œå®ƒä¸€å®šæ˜¯å­˜åœ¨äºå†…å­˜ä¸­çš„ã€‚å¯¹è±¡ä¸å¯è¾¾æ—¶ï¼Œä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶
- è¢«å¼•ç”¨ä¸å¯è®¿é—®ï¼ˆä»ä¸€ä¸ªæ ¹ï¼‰ä¸åŒï¼šä¸€ç»„ç›¸äº’è¿æ¥çš„å¯¹è±¡å¯èƒ½æ•´ä½“éƒ½ä¸å¯è¾¾ã€‚åƒåœ¾å›æ”¶æ˜¯ä»¥å¯è¾¾æ€§ä¸ºä¾æ®çš„

### å¯¹è±¡æ–¹æ³•,this
**å¯¹è±¡æ–¹æ³•ç®€å†™**
```javascript
// è¿™äº›å¯¹è±¡ä½œç”¨ä¸€æ ·,ä½†åœ¨å¯¹è±¡ç»§æ‰¿æ–¹é¢æœ‰ä¸€äº›ç»†å¾®çš„å·®åˆ«

user = {
  sayHi: function() {
    alert("Hello");
  }
};

user = {
  sayHi() { // ä¸ "sayHi: function()" ä¸€æ ·
    alert("Hello");
  }
};
```

**this**
thisçš„å€¼æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶å¾—åˆ°çš„ã€‚

- ä¸€ä¸ªå‡½æ•°åœ¨å£°æ˜æ—¶ï¼Œå¯èƒ½å°±ä½¿ç”¨äº† thisï¼Œä½†æ˜¯è¿™ä¸ªthisåªæœ‰åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰ä¼šæœ‰å€¼ã€‚
- å¯ä»¥åœ¨å¯¹è±¡ä¹‹é—´å¤åˆ¶å‡½æ•°ï¼Œä½¿å¯¹è±¡å¤åˆ¶åæ–¹æ³•è°ƒç”¨(ä½¿ç”¨å¯¹è±¡å±æ€§)ä¸ä¼šå‡ºé”™
- ä»¥â€œæ–¹æ³•â€çš„è¯­æ³•è°ƒç”¨å‡½æ•°æ—¶ï¼šobject.method()ï¼Œè°ƒç”¨è¿‡ç¨‹ä¸­çš„ this å€¼æ˜¯ objectã€‚
- è¯·æ³¨æ„ç®­å¤´å‡½æ•°æœ‰äº›ç‰¹åˆ«ï¼šå®ƒä»¬æ²¡æœ‰ thisã€‚åœ¨ç®­å¤´å‡½æ•°å†…éƒ¨è®¿é—®åˆ°çš„ this éƒ½æ˜¯ä»å¤–éƒ¨è·å–çš„ã€‚

### æ„é€ å™¨å’Œæ“ä½œç¬¦ "new"
- æ„é€ å‡½æ•°ï¼Œæˆ–ç®€ç§°æ„é€ å™¨ï¼Œå°±æ˜¯å¸¸è§„å‡½æ•°ï¼Œæ„é€ å™¨çº¦å®šå…¶å‘½åé¦–å­—æ¯å¤§å†™ï¼Œåªèƒ½ä½¿ç”¨ new æ¥è°ƒç”¨ã€‚
- å‡½æ•°è¢«newæ“ä½œç¬¦æ‰§è¡Œæ—¶ï¼Œåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡å¹¶ç»™äº†thisï¼Œå‡½æ•°ä½“æ‰§è¡Œä¸ºthisï¼Œæ·»åŠ æ–°çš„å±æ€§ï¼Œæ¥ç€è¿”å›thisçš„å€¼ã€‚
```javascript
// newæ“ä½œç¬¦æ‰§è¡Œæµç¨‹ä¸æ­¤ç±»ä¼¼
function User(name) {
  // this = {};ï¼ˆéšå¼åˆ›å»ºï¼‰

  // æ·»åŠ å±æ€§åˆ° this
  this.name = name;
  this.isAdmin = false;

  // return this;ï¼ˆéšå¼è¿”å›ï¼‰
}
```
- å‡½æ•°å†…éƒ¨é€šè¿‡new.targetå±æ€§,ç¡®å®šæ˜¯æ„é€ å™¨æ‰§è¡Œ(new.targetå±æ€§ä¸ºå‡½æ•°)è¿˜æ˜¯å¸¸è§„è°ƒç”¨(new.targetå±æ€§ä¸ºundefined),
- jså†…ç½®å¯¹è±¡é€šè¿‡new.targetå±æ€§å¯ä»¥å®ç°æ„é€ å™¨æ‰§è¡Œçš„æ—¶å€™çœç•¥newå…³é”®å­—
```javascript
// å®ç°æ„é€ å™¨çœç•¥newå…³é”®å­—
function User(name,age){
    if(!new.target){
        return new User(name,age)
    }
    this.name = name;
    this.age = age
    cache = true
}

let user = User('å—å®«',25)
console.log(user);
```
- æ„é€ å™¨ä¸€èˆ¬æ²¡æœ‰returnã€‚å¦‚æœæœ‰çš„è¯å¹¶ä¸”æ˜¯ä¸ªå¯¹è±¡ç±»å‹çš„è¯å°†ä¼šè¦†ç›–thisã€‚è¿”å›åŸå§‹ç±»å‹æ— å½±å“ã€‚
```javascript
function BigUser() {

  this.name = "John";

  return { newname: "Godzilla" };  // <-- è¿”å›è¿™ä¸ªå¯¹è±¡
}

console.log( new BigUser().newname );  // Godzillaï¼Œå¾—åˆ°äº†é‚£ä¸ªå¯¹è±¡
console.log( new BigUser().name );  // undefined
```

### å¯é€‰é“¾ "?."
å¯é€‰é“¾ ?. æ˜¯ä¸€ç§è®¿é—®åµŒå¥—å¯¹è±¡å±æ€§çš„å®‰å…¨çš„æ–¹å¼ã€‚å³ä½¿ä¸­é—´çš„å±æ€§ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šå‡ºç°é”™è¯¯ã€‚ä¸ä¼šå‡ºé”™çš„åŒæ—¶ä¹Ÿç»™æˆ‘ä»¬åœ¨ç¼–ç¨‹ä¸Šé¢é€ æˆä¸€å®šå›°æ‰°ã€‚ä»…åœ¨å½“å·¦è¾¹éƒ¨åˆ†ä¸å­˜åœ¨ä¹Ÿæ²¡é—®é¢˜çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸ºå®œã€‚
- å¯é€‰é“¾ ?. ä¸æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œè€Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è¯­æ³•ç»“æ„
  - obj?.prop â€”â€” å¦‚æœ obj å­˜åœ¨åˆ™è¿”å› obj.propï¼Œå¦åˆ™è¿”å› undefinedã€‚
  - obj?.[prop] â€”â€” å¦‚æœ obj å­˜åœ¨åˆ™è¿”å› obj[prop]ï¼Œå¦åˆ™è¿”å› undefinedã€‚
  - obj.method?.() â€”â€” å¦‚æœ obj.method å­˜åœ¨åˆ™è°ƒç”¨ obj.method()ï¼Œå¦åˆ™è¿”å› undefinedã€‚
```javascript
// å¦‚æœ document.querySelector('.elem') çš„ç»“æœä¸º nullï¼Œåˆ™è¿™é‡Œä¸å­˜åœ¨è¿™ä¸ªå…ƒç´ 
let html = document.querySelector('.elem').innerHTML; // å¦‚æœ document.querySelector('.elem') çš„ç»“æœä¸º nullï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯

// å¯é€‰é“¾ ?. è§£å†³é”™è¯¯
let html = document.querySelector('.elem')?.innerHTML;
console.log(html)// undefined

```

### Iterable objectï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰
- `for (let key of obj)`  ä¸­çš„objå¯¹è±¡éƒ½æ˜¯å¯è¿­ä»£çš„ã€‚
- å¯è¿­ä»£å¯¹è±¡å¿…é¡»å®ç° Symbol.iterator æ–¹æ³•ã€‚
- `obj[Symbol.iterator]()`çš„ç»“æœè¢«ç§°ä¸º è¿­ä»£å™¨ï¼ˆiteratorï¼‰ã€‚ç”±å®ƒå¤„ç†è¿›ä¸€æ­¥çš„è¿­ä»£è¿‡ç¨‹ã€‚
- ä¸€ä¸ªè¿­ä»£å™¨å¿…é¡»æœ‰next()æ–¹æ³•ï¼Œå®ƒè¿”å›ä¸€ä¸ª {done: Boolean, value: any} å¯¹è±¡ï¼Œè¿™é‡Œ done:true è¡¨æ˜è¿­ä»£ç»“æŸï¼Œå¦åˆ™ value å°±æ˜¯ä¸‹ä¸€ä¸ªå€¼ã€‚
- Symbol.iteratoræ–¹æ³•ä¼šè¢« for..of è‡ªåŠ¨è°ƒç”¨ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒã€‚
- å†…ç½®çš„å¯è¿­ä»£å¯¹è±¡ä¾‹å¦‚å­—ç¬¦ä¸²å’Œæ•°ç»„ï¼Œéƒ½å®ç°äº† Symbol.iteratorã€‚
- å­—ç¬¦ä¸²è¿­ä»£å™¨èƒ½å¤Ÿè¯†åˆ«ä»£ç†å¯¹surrogate pair(UTF-16 æ‰©å±•å­—ç¬¦ ğŸ˜‚ğ©·¶)ã€‚
```javascript
/**
 * ä½¿range å¯¹è±¡å¯è¿­ä»£
*/
let range = {
    from:2,
    to:5
}

// 1. for..of è°ƒç”¨é¦–å…ˆä¼šè°ƒç”¨è¿™ä¸ªï¼š
range[Symbol.iterator] = function (){
    // â€¦â€¦å®ƒè¿”å›è¿­ä»£å™¨å¯¹è±¡ï¼ˆiterator objectï¼‰ï¼š
    // 2. æ¥ä¸‹æ¥ï¼Œfor..of ä»…ä¸æ­¤è¿­ä»£å™¨ä¸€èµ·å·¥ä½œï¼Œè¦æ±‚å®ƒæä¾›ä¸‹ä¸€ä¸ªå€¼
    return {
        current:this.from,
        last:this.to,
        // 3. next() åœ¨ for..of çš„æ¯ä¸€è½®å¾ªç¯è¿­ä»£ä¸­è¢«è°ƒç”¨
        next(){
            // 4. å®ƒå°†ä¼šè¿”å› {done:.., value :...} æ ¼å¼çš„å¯¹è±¡
            if(this.current<=this.last){
                return {done:false,value:this.current++}
            }else{
                return {done:true}
            }
        }
    }
}
for(let num of range){
    console.log(num);
}


/** 
 * rangeè‡ªèº«ä½œä¸ºè¿­ä»£å™¨
*/
let range = {
    from:1,
    to:5,

    [Symbol.iterator](){
        this.current = this.from
        return this
    },
    next(){
        if(this.current<=this.to){
            return {done:false,value:this.current++}
        }else{
            return {done:true}
        }
    }
}

let iterator = range[Symbol.iterator]()
while(true){
    const res = iterator.next()
    if(res.done){
        break
    }
    console.log(res.value);
}
// for(let num of range){
//     console.log(num);
// }

/** 
 * æ˜¾å¼è°ƒç”¨è¿­ä»£å™¨
*/
let str = "nangong"
// å®ç°for..of ç›¸åŒçš„æ•ˆæœ
let iterator = str[Symbol.iterator]()
// console.log(iterator);
while(true){
    const res = iterator.next()
    if(res.done){
        break
    }
    console.log(res.value);
}

```
**å¯è¿­ä»£iterableå’Œç±»æ•°ç»„array-like**
- å¯è¿­ä»£æ˜¯æŒ‡å®ç°äº†Symbol.iteratoræ–¹æ³•çš„å¯¹è±¡
- ç±»æ•°ç»„æ˜¯æŒ‡å…·æœ‰ç´¢å¼•å’Œlengthå±æ€§çš„å¯¹è±¡
- `Array.from(obj[, mapFn, thisArg])` å¯ä»¥æ¥å—ä¸€ä¸ªå¯è¿­ä»£æˆ–ç±»æ•°ç»„çš„å€¼ï¼Œå¹¶ä»ä¸­è·å–ä¸€ä¸ªâ€œçœŸæ­£çš„â€æ•°ç»„ã€‚å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•° mapFn å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåœ¨å¯¹è±¡ä¸­çš„å…ƒç´ è¢«æ·»åŠ åˆ°æ•°ç»„å‰ï¼Œè¢«åº”ç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œæ­¤å¤– thisArg å…è®¸æˆ‘ä»¬ä¸ºè¯¥å‡½æ•°è®¾ç½® thisã€‚
```javascript
/**
* 
*/
// å¯è¿­ä»£ï¼ˆiterableï¼‰
let a = 115
// å¦‚æœaä¸æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡a[Symbol.iterator]()è°ƒç”¨ä¼šæŠ¥é”™
a[Symbol.iterator]() // a[Symbol.iterator] is not a function

let  iterable = " rre" 
iterable[Symbol.iterator]() //ä¼šè¿”å›Object [String Iterator] {}

// ç±»æ•°ç»„ï¼ˆarray-likeï¼‰

let arrayLike={
    0:"nangong",
    1:"kyo",
    length:2
}
//  Array.from å¯ä»¥æ¥å—ä¸€ä¸ªå¯è¿­ä»£æˆ–ç±»æ•°ç»„çš„å€¼ï¼Œå¹¶ä»ä¸­è·å–ä¸€ä¸ªâ€œçœŸæ­£çš„â€æ•°ç»„ã€‚
let arr = Array.from(arrayLike)
console.log(arr);// [ 'nangong', 'kyo' ]
let  iterable = " rre" 
let charArr = Array.from(iterable)
console.log(charArr);// [ ' ', 'r', 'r', 'e' ]


/** 
 * å®ç°èƒ½å¤Ÿå¤„ç† UTF-16 æ‰©å±•å­—ç¬¦çš„ slice æ–¹æ³•
 * v8ä¸‹è¿è¡Œç»“æœ
 */
 let str = 'ğ’³ğŸ˜‚ğ©·¶';
 console.log( str.slice(1, 3) ); // ğŸ˜‚ğ©·¶
 function slice(str,start,end){
     return Array.from(str).slice(start,end).join("")
 }
 console.log(slice(str,1,3));

```

### å¯¹è±¡è½¬æ¢

å½“ä¸€ä¸ªå¯¹è±¡è¢«ç”¨åœ¨éœ€è¦åŸå§‹å€¼çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯¹è±¡ä¼šè¢«è‡ªåŠ¨è½¬æ¢ç›¸åº”çš„ç±»å‹
è¿™é‡Œæœ‰ä¸‰ç§ç±»å‹ï¼ˆhintï¼‰,å¸¸å¸¸å°†numberå’Œdefaultå½’ä¸ºä¸€ç±»ï¼š
- "string"ï¼ˆå¯¹äº alert å’Œå…¶ä»–éœ€è¦å­—ç¬¦ä¸²çš„æ“ä½œï¼‰
- "number"ï¼ˆå¯¹äºæ•°å­¦è¿ç®—ï¼‰
- "default"ï¼ˆå°‘æ•°è¿ç®—ç¬¦ï¼‰

è½¬æ¢ç®—æ³•æ˜¯ï¼š
- è°ƒç”¨ obj[Symbol.toPrimitive](hint) å¦‚æœè¿™ä¸ªæ–¹æ³•å­˜åœ¨ï¼Œ
- å¦åˆ™ï¼Œå¦‚æœ hint æ˜¯ "string"
  - å°è¯• obj.toString()-> obj.valueOf()ã€‚
  - å¦åˆ™ï¼Œå¦‚æœ hint æ˜¯ "number" æˆ–è€… "default"
  - å°è¯• obj.valueOf() -> obj.toString()ã€‚
```javascript
let user = {
    name:"nangong",
    age:25,
    money:1000,

    // [Symbol.toPrimitive](hint){
    //     return hint == 'string' ? this.name :this.age+this.money
    // },
    // å¯¹äº hint="string"
    toString() {
        return `{name: "${this.name}"}`;
    },

    // å¯¹äº hint="number" æˆ– "default"
    valueOf() {
        return this.money;
    }
}
alert(user);
alert(+user);
alert(user+500);

// å¦‚æœæ²¡æœ‰ Symbol.toPrimitive å’Œ valueOfï¼ŒtoString å°†å¤„ç†æ‰€æœ‰åŸå§‹è½¬æ¢ã€‚
let user1 = {
    name: "kyo",

    toString() {
      return this.name;
    }
  };

alert(user1); // toString -> kyo
alert(user1 + 500); // toString -> kyo500
```